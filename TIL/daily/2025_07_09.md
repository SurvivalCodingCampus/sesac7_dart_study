# DTO, Mapper

## 과제 피드백
#### 1. http 통신 시 모든 통신은 성공이다. 200번이나 400번이나 통신은 모두 성공한 것이지만, 상태가 다른 것이다.

#### 2. http 통신 시 요청을 날리기 전에는 서버 측의 상태를 알 수 없다.(Stateless)
예: 우리는 300번 id의 데이터를 서버가 가지고 있는지 모르는 상태에서 요청을 날린다.

#### 3. 인코딩/디코딩을 Repository에서 맡을지, DataSource에서 맡을지는 생각해볼 필요가 있겠다.

## DTO(Data Transfer Object)
- Json을 그대로 담는 중간 전달 객체라고 생각하면 된다.

- DataSource 혹은 비즈니스 로직 모두의 잘못이 아닌데, fromJson 등 변환에서 에러가 발생할 경우 책임을 나눌 필요가 있다.(잘못된 소스를 받더라도 터지지 않게 하기 위함)

- 모든 케이스를 담기 위해 모든 필드를 nullable로 제공하고, 직렬화/역직렬화를 제공한다.
    - jsonToDart를 활용하면 좋다.
    - DTO에 직렬화/역직렬화 기능이 포함되므로, 모델 클래스에서 해당 기능이 빠져도 된다.

## Mapper
- DTO를 모델 클래스로 변환하는 기능을 한다.
    - 확장함수를 통해 다른 클래스에 기능을 넣어주고, 원본 모델 혹은 DTO에 사용자가 직접 작성하는 것을 지양한다.
    - 그렇게 사용할 경우 사람이 작성한 부분은 Mapper 뿐이기 때문에, 에러가 발생하면 Mapper만 수정해주면 된다.

- fromJson, toJson도 Mapper이며, 데이터 형태에 상관없이 변환 기능을 가지면 Mapper에 작성한다.

- Repository에서 Mapper에 작성한 메소드를 활용한다고 보면 된다.

## 내가 이해한 흐름?
    1. DataSource는 DataBase와의 연결을 통해 데이터를 가져온다.

    2. 어떤 형태의 데이터가 들어오던 간에 에러가 나지 않게 하기 위해, 데이터를 DTO로 만든다. DataSource에서 Repository로 데이터를 제공할 때, DTO로 변환되어 전달된다.

    3. Repository는 DTO의 내용을 토대로 모델 클래스 객체로 변환한다. 이때 Mapper에 확장 함수로 정의해놓은 "DTO -> 모델" 기능을 하는 메서드를 사용하여 모델 클래스 객체로 변환한다.

    4. 비즈니스 로직에서 데이터를 사용할 때는 DTO에서 검증된 형태의 데이터를 사용하기 때문에 문제가 생길 확률이 적다. 만약 문제가 생긴다면 Mapper에 정의한 메서드의 로직이 잘못되었을 가능성이 크다.
    (DTO는 jsonToDart 기능을 이용하며, 모델 클래스도 freezed를 이용하므로, 사람이 작성한 것은 Mapper뿐이다.)